<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Manage Menu</title>
</head>
<body>
    <h1>Manage Categories and Menu Items</h1>
    
    <h2>Categories</h2>
    <div id="categories"></div>
    <button onclick="addCategory()">Add Category</button>
    
    <h2>Menu Items</h2>
    <div id="menuitems"></div>
    <button onclick="addMenuItem()">Add Menu Item</button>
    
    <script>
        const apiBaseUrl = 'http://localhost:8000/cafeAdmin/api/';

        // Fetch categories and menu items
        function fetchData() {
            fetch(`${apiBaseUrl}categories/`)
                .then(response => response.json())
                .then(data => displayCategories(data));

            fetch(`${apiBaseUrl}menuitems/`)
                .then(response => response.json())
                .then(data => displayMenuItems(data));
        }

        // Display categories
        function displayCategories(categories) {
            const categoriesDiv = document.getElementById('categories');
            categoriesDiv.innerHTML = '';
            categories.forEach(category => {
                categoriesDiv.innerHTML += `<div>
                    ${category.name} 
                    <button onclick="editCategory(${category.id})">Edit</button>
                    <button onclick="deleteCategory(${category.id})">Delete</button>
                </div>`;
            });
        }

        // Display menu items
        function displayMenuItems(menuItems) {
            const menuItemsDiv = document.getElementById('menuitems');
            menuItemsDiv.innerHTML = '';
            menuItems.forEach(item => {
                menuItemsDiv.innerHTML += `<div>
                    ${item.name} (${item.category}) - $${item.price}
                    <button onclick="editMenuItem(${item.id})">Edit</button>
                    <button onclick="deleteMenuItem(${item.id})">Delete</button>
                </div>`;
            });
        }

        // Add category
        function addCategory() {
            const name = prompt('Enter category name:');
            if (name) {
                fetch(`${apiBaseUrl}categories/`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ name })
                }).then(() => fetchData());
            }
        }

        // Edit category
        function editCategory(id) {
            const name = prompt('Enter new category name:');
            if (name) {
                fetch(`${apiBaseUrl}categories/${id}/`, {
                    method: 'PUT',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ name })
                }).then(() => fetchData());
            }
        }

        // Delete category
        function deleteCategory(id) {
            if (confirm('Are you sure you want to delete this category?')) {
                fetch(`${apiBaseUrl}categories/${id}/`, {
                    method: 'DELETE'
                }).then(() => fetchData());
            }
        }

        // Add menu item
        function addMenuItem() {
            const name = prompt('Enter menu item name:');
            const description = prompt('Enter menu item description:');
            const price = prompt('Enter menu item price:');
            const category = prompt('Enter menu item category ID:');
            if (name && description && price && category) {
                fetch(`${apiBaseUrl}menuitems/`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ name, description, price, category })
                }).then(() => fetchData());
            }
        }

        // Edit menu item
        function editMenuItem(id) {
            const name = prompt('Enter new menu item name:');
            const description = prompt('Enter new menu item description:');
            const price = prompt('Enter new menu item price:');
            const category = prompt('Enter new menu item category ID:');
            if (name && description && price && category) {
                fetch(`${apiBaseUrl}menuitems/${id}/`, {
                    method: 'PUT',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ name, description, price, category })
                }).then(() => fetchData());
            }
        }

        // Delete menu item
        function deleteMenuItem(id) {
            if (confirm('Are you sure you want to delete this menu item?')) {
                fetch(`${apiBaseUrl}menuitems/${id}/`, {
                    method: 'DELETE'
                }).then(() => fetchData());
            }
        }

        // Initial data fetch
        fetchData();
    </script>
</body>
</html>
